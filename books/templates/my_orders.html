<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>My Orders</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<body>
<div class="container mt-5">

    <!-- üîπ Back to Home button at the top -->
    <div class="text-start mb-3">
        <a href="{% url 'home' %}" class="btn btn-outline-primary">‚Üê Back to Home</a>
    </div>

    <h2 class="text-center mb-4">My Orders</h2>


    {% if orders %}
        {% for order in orders %}
        <div class="card mb-4 shadow-sm">
            <div class="card-body">
                <h5>Order ID: {{ order.id }}</h5>
                <p><strong>Placed on:</strong> {{ order.created_at }}</p>
                <p><strong>Status:</strong> {{ order.status }}</p>

                <div class="row">
                    {% for item in order.items.all %}
                    <div class="col-md-4 mb-3">
                        <div class="card h-100">
                            <img src="{{ item.book.cover_image }}" class="card-img-top" style="height: 150px; object-fit: cover;" alt="Book Image">
                            <div class="card-body">
                                <h6>{{ item.book.title }}</h6>
                                <p>Qty: {{ item.quantity }}</p>
                                <p>Price: ‚Çπ{{ item.price }}</p>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>

                <p class="mt-3"><strong>Total:</strong> ‚Çπ{{ order.total_price }}</p>

                {% if order.status != 'Cancelled' %}
                <form method="POST" action="{% url 'cancel_order' order.id %}">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger">Cancel Order</button>
                </form>
                {% else %}
                <p class="text-danger">This order has been cancelled.</p>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    {% else %}
        <div class="alert alert-info text-center">No orders placed yet.</div>
        <div class="text-center">
           <a href="{% url 'home' %}" class="btn btn-primary">Keep Shopping</a>
        </div>
    {% endif %}
</div>
</body>
</html>
